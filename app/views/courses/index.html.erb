<div class="index-courses">
  <div class="head">
    <div class="image-wrapper">
      <img src="https://plus.unsplash.com/premium_photo-1661776608612-523ebf5a19d2?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="train photo">
      <div class="overlay">
        <h1>Training</h1>
      </div>
    </div>

  </div>



    <h1 class="page-title">All courses</h1>

    <section class="categories">
      <div class="category-name">
        <a href="#" data-category="CONSTRUCTION">Construction</a>
        <a href="#" data-category="MANAGEMENT">Management</a>
        <a href="#" data-category="RAIL">Rail</a>
        <a href="#" data-category="ALL">All</a>
      </div>
    </section>

    <% if current_user.admin == true %>
      <%= link_to 'Create a new course', new_course_path, class: 'gradient-button' %>
    <% end %>

    <div id="courses-container">
      <%= render partial: 'courses_list', locals: { courses: @courses } %>
    </div>

<div class="divider-text">
  <span>Let's make one happen</span>
</div>






<div class="interest-registration">
  <div class="interest-text">
    <h2>Don't see a course you're looking for?</h2>
    <p>Let us know, and we'll do our best to organize one as soon as possible!</p>
  </div>
  <form class="interest-form">
    <input type="text" name="name" placeholder="Your Name" required>
    <input type="email" name="email" placeholder="Your Email" required>
    <textarea name="course-details" placeholder="What course are you interested in?" required></textarea>
    <button type="submit" class="gradient-button">Register Interest</button>
  </form>
</div>



  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const links = document.querySelectorAll('.category-name a');

      links.forEach(link => {
        link.addEventListener('click', (event) => {
          event.preventDefault();

          const category = event.target.dataset.category;
          console.log(category);
          fetch(`/courses/filter_by_category?category=${category}`, {
            headers: {
              'X-Requested-With': 'XMLHttpRequest'
            }
          })
          .then(response => response.text())
          .then(html => {
            console.log(html);
            document.getElementById('courses-container').innerHTML = html;
          })
          .catch(error => console.error('Error fetching courses:', error));
        });
      });
    });
  </script>


</div>
